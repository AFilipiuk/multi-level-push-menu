(function(a){a.fn.multilevelpushmenu=function(b){return this.each(function(){var j=a(this),r=(j.context!=undefined)?j:a("body"),k=0,d=(b.menu!=undefined)?b.menu:j.find("nav");var u=a.extend({container:r,containersToPush:null,menuID:((r.prop("id")!=undefined&&r.prop("id")!="")?r.prop("id"):this.nodeName.toLowerCase())+"_multilevelpushmenu",wrapperClass:"multilevelpushmenu_wrapper",menuInactiveClass:"multilevelpushmenu_inactive",menu:d,menuWidth:0,menuHeight:0,backText:"Back",backItemClass:"backItemClass",backItemIcon:"fa fa-angle-right",groupIcon:"fa fa-angle-left",mode:"overlap",overlapWidth:40},b);function o(w){if(w.stopPropagation&&w.preventDefault){w.stopPropagation();w.preventDefault()}else{w.cancelBubble=true;w.returnValue=false}}function t(){var w=a("<nav />").prop({id:u.menuID,className:u.wrapperClass}).appendTo(u.container);m(u.menu,w);s()}function m(x,w){if(x.level==undefined){x.level=0}a.each(x,function(){var C=a("<div />").attr({"class":"levelHolderClass","data-level":x.level,style:"left: "+((x.level==0)?0:"-200%")}).appendTo(w);var y=(v(u.menuWidth)||(h(u.menuWidth)&&u.menuWidth>0));if(y){C.width(u.menuWidth)}var A=a("<h2 />").text(this.title).appendTo(C);var z=a("<i />").prop({"class":"floatRight cursorPointer "+this.icon}).prependTo(A);z.click(function(D){f(D,C,x)});if(x.level>0){n(C)}var B=a("<ul />").appendTo(C);a.each(this.items,function(){var E=a("<li />").appendTo(B);var D=a("<a />").prop({href:this.link}).text(this.name).appendTo(E);var F=a("<i />").prop({"class":"floatRight "+this.icon}).prependTo(D);if(this.items){D.click(function(G){g(G,C,E)});i(D);this.items.level=x.level+1;m(this.items,E)}})})}function e(){var w=u.menu;if(w.length==0){return false}w.prop({id:u.menuID,className:u.wrapperClass});q(w);s()}function q(w){if(w.level==undefined){w.level=0}a.each(w,function(){var B=a("<div />").attr({"class":"levelHolderClass","data-level":w.level,style:"left: "+((w.level==0)?0:"-200%")}).appendTo(w);var x=(v(u.menuWidth)||(h(u.menuWidth)&&u.menuWidth>0));if(x){B.width(u.menuWidth)}var z=w.children("h2");z.appendTo(B);var y=z.children("i");y.addClass("floatRight cursorPointer");y.click(function(C){f(C,B,w)});if(w.level>0){n(B)}var A=w.children("ul");A.appendTo(B);a.each(A.children("li"),function(){var D=a(this);var C=D.children("a");var E=C.children("i");E.addClass("floatRight");if(D.children("ul").length>0){C.click(function(F){g(F,B,D)});i(C);D.level=w.level+1;q(D)}})})}function f(A,z,y){if(a(".levelHolderClass").is(":animated")){return false}var w;o(A);if(y.level==0&&z.position().left<0){z.removeClass(u.menuInactiveClass);z.animate({left:0},function(){z.find("ul").show(500)});p(z.width()-u.overlapWidth)}else{var B=u.container.find("#"+u.menuID+" div.levelHolderClass").filter(function(){return((a(this).attr("data-level")>z.attr("data-level"))&&(a(this).position().left>=0))});var x=u.container.find("#"+u.menuID+" div.levelHolderClass").filter(function(){return((a(this).attr("data-level")<=z.attr("data-level"))&&(a(this).position().left>=0))});if(B.length==0){if(y.level==0){z.stop().animate({left:((-1)*z.width()+u.overlapWidth)},function(){z.find("ul").hide(500,function(){z.addClass(u.menuInactiveClass)})});p((-1)*z.width()+u.overlapWidth)}}else{B.each(function(C,D){w=(a(D).css("filter").match(/DXImageTransform\.Microsoft\.Shadow/))?a(D).get(0).filters.item("DXImageTransform.Microsoft.Shadow").strength:0;a(D).stop().animate({left:"-100%",width:a(D).width()-(B.length+x.length-a(D).attr("data-level")-1)*(u.overlapWidth+w)-w})});x.each(function(C,D){w=(a(D).css("filter").match(/DXImageTransform\.Microsoft\.Shadow/))?a(D).get(0).filters.item("DXImageTransform.Microsoft.Shadow").strength:0;a(D).stop().animate({width:a(D).width()-B.length*(u.overlapWidth+w)-w});p((-1)*(B.length*(u.overlapWidth+w)))})}z.css("visibility","visible");z.find("."+u.backItemClass).css("visibility","visible");z.find("ul").css("visibility","visible");z.removeClass(u.menuInactiveClass)}}function n(z){var w=a("<div />").attr({"class":u.backItemClass}).appendTo(z);var x=a("<a />").prop({href:"#"}).text(u.backText).appendTo(w);var y=a("<i />").prop({"class":"floatRight "+u.backItemIcon}).prependTo(x);x.click(function(A){c(A,z)})}function c(A,z){if(a(".levelHolderClass").is(":animated")){return false}var x;o(A);if(u.mode=="overlap"){var w=u.container.find("#"+u.menuID+" div.levelHolderClass").filter(function(){return(a(this).position().left>=0&&a(this)!=z)});w.each(function(B,C){x=(a(C).css("filter").match(/DXImageTransform\.Microsoft\.Shadow/))?a(C).get(0).filters.item("DXImageTransform.Microsoft.Shadow").strength:0;a(C).stop().animate({width:a(C).width()-u.overlapWidth-(x*2)},function(){a(C).removeClass(u.menuInactiveClass)});p((-1)*(u.overlapWidth+x))});var y=u.container.find("#"+u.menuID+" div.levelHolderClass").filter(function(){return(a(this).attr("data-level")==z.attr("data-level")-1)});y.css("visibility","visible");y.find("."+u.backItemClass).css("visibility","visible");y.find("ul").css("visibility","visible")}z.stop().animate({left:"-100%",width:z.width()-(x*2)})}function g(A,z,y){if(a(".levelHolderClass").is(":animated")){return false}var x;o(A);if(u.mode=="overlap"){var w=u.container.find("#"+u.menuID+" div.levelHolderClass").filter(function(){return(a(this).position().left>=0&&a(this)!=z)});w.each(function(C,D){x=(a(D).css("filter").match(/DXImageTransform\.Microsoft\.Shadow/))?a(D).get(0).filters.item("DXImageTransform.Microsoft.Shadow").strength:0;a(D).stop().animate({width:a(D).width()+u.overlapWidth},function(){a(D).addClass(u.menuInactiveClass)});p(u.overlapWidth+x)});var B=u.container.find("#"+u.menuID+" div.levelHolderClass").filter(function(){return(a(this).attr("data-level")>z.attr("data-level"))});w.find("ul").css("visibility","hidden");w.find("."+u.backItemClass).css("visibility","hidden");B.css("visibility","visible");B.find("."+u.backItemClass).css("visibility","visible");B.find("ul").css("visibility","visible")}y.find("div:first").removeClass(u.menuInactiveClass).stop().animate({left:0})}function i(w){var x=a("<i />").prop({"class":"iconSpacing "+u.groupIcon}).prependTo(w)}function s(){var A=Math.max.apply(null,a("#"+u.menuID+" div.levelHolderClass").map(function(){return a(this).width()}).get()),w=Math.max.apply(null,a("#"+u.menuID+" div.levelHolderClass").map(function(){return a(this).attr("data-level")}).get()),B=A+w*u.overlapWidth,z=Math.max.apply(null,a("#"+u.menuID+" div.levelHolderClass").map(function(){return a(this).height()}).get());var x=(v(u.menuWidth)||(h(u.menuWidth)&&u.menuWidth>0)),y=(v(u.menuHeight)||(h(u.menuHeight)&&u.menuHeight>0));(x)?a("#"+u.menuID+" div.levelHolderClass").width(u.menuWidth):a("#"+u.menuID+" div.levelHolderClass").width(A);(y)?a("#"+u.menuID).height(u.menuHeight):a("#"+u.menuID).height(z);r.width(B);r.height(z)}function p(w){if(u.containersToPush==null){return false}a.each(u.containersToPush,function(){a(this).stop().animate({marginLeft:a(this).offset().left-a(this).position().left+w})})}function h(w){return typeof w==="number"&&parseFloat(w)==parseInt(w,10)&&!isNaN(w)}function v(w){return typeof w==="string"&&(w.indexOf("%")!=-1||w.indexOf("px")!=-1||w.indexOf("em")!=-1)}var l=(b.menu!=undefined)?t():e()})}}(jQuery));